#13.捕获型括号

##13.1 Markdown翻译为HTML

 **Markdown** 是一种轻量级标记语言，它允许人们 **“使用易读易写的纯文本格式编写文档，然后转换成有效的XHTML(或者HTML)文档”** ，例如：

```
#恒大4-0横扫人和 埃神建功黄博文2球郑智破荒
```

以上是一个Markdown标记语言， **#** 表示一级标题，经过一些 **特殊处理** ，可以转化为HTML文档：

```html
<h1>恒大4-0横扫人和 埃神建功黄博文2球郑智破荒</h1>
```

不难猜到，其实上面提到的 **特殊处理** ，指的就是正则表达式的替换。

我们可以使用Java的<code>replaceAll</code>方法来进行替换操作。

为了简单，我们可以使用<code>#.*</code>来替换以#开头的任何文本，代码粗略如下：

```java
String text = "#恒大4-0横扫人和 埃神建功黄博文2球郑智破荒";
String result = text.replaceAll("#.*", ??);
```

这里问题来了，我们怎么使用\<h1\>标签来包裹我们的标题呢。这里我们要引入一个很重要的概念： **捕获型括号** ，所谓捕获型括号，就是使用括号括住我们的目标文本（这里是[恒大4-0横扫人和 埃神建功黄博文2球郑智破荒]），然后使用 **$num** 对目标进行引用（num为具体的数字，例如$1,$2分别表示第一组和第二组捕获文本）。那我们的代码可以改写为：

```java
String text = "#恒大4-0横扫人和 埃神建功黄博文2球郑智破荒";
String result = text.replaceAll("#(.*)", "<h1>$1</h1>");

// 输出：<h1>恒大4-0横扫人和 埃神建功黄博文2球郑智破荒</h1>
```
以上的代码，我们将.* 用括号包围起来，表示这是一个捕获文本，然后再方法的第二个参数中使用 **$1** 来引用捕获的文本，然后使h1将其包围。在这里，$1相当于一个变量，它的值为第一个捕获型括号捕获的文本，相当于
> $1="恒大4-0横扫人和 埃神建功黄博文2球郑智破荒"

这里我们完成了Markdown语言到HTML的翻译，但是请注意，这里演示的正则表达式是有BUG的。

##13.2 捕获型括号

在目前为止，我们已经学到了括号的两种作用：1、限定<code>?</code><code>+</code><code>+</code>等的作用范围；2、捕获文本。

一个括号捕获的文本，我们称为 **组**， **$1** 称为 **组1** ，以此类推。一个正则表达式中，有多少个括号，就有对应个数的组。
从正则表达式的第一个大括号开始为$1，其嵌套的括号为$2，以此类推。例如正则：

```
正则：(abc(efg(123(456))))(@#$)
```

这个正则表达式共出现了5个括号，所以有5个组，第一个大括号为$1，一次内嵌的括号为$2、$3、$4，然后临近的组为$5。如下图所示：

<img src="http://farm8.staticflickr.com/7283/8884731109_22712de8dd.jpg"/>

有些时候，我们只想使用括号进行范围限制，但不想进行文本匹配，这时候我们可以使用 **(?:)** 来代替括号。 像上一个表达式中，
我们并不想匹配$2和$4，我们可以使用 **(?:)** 来代替 **()**。这时，该表达式的组只剩下3个。修改后的正则如下：

>(abc(?:efg(123(?:456))))(@#$)

组捕获结果如下：

<img src="http://farm4.staticflickr.com/3751/8884862029_11c86f9f9c.jpg" />

******************************
>(pattern)     // 捕获型括号，匹配的同时，进行文本捕获

>(?:pattern)   // 非捕获型括号，只做匹配，不进行文本捕获

******************************

